FROM node:14

ENV POSTGRES_USERNAME=${POSTGRES_USERNAME} \
	POSTGRES_PASSWORD=${POSTGRES_PASSWORD} \
	POSTGRES_HOST=${POSTGRES_HOST} \
	POSTGRES_DB=${POSTGRES_DB} \
	AWS_BUCKET=${AWS_BUCKET} \
	AWS_REGION=${AWS_REGION} \
	AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID} \
	AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY} \
	JWT_SECRET=${JWT_SECRET} \
	URL=${URL} 

WORKDIR /usr/src/app

COPY package*.json ./

RUN npm i

COPY . .

EXPOSE 8080

CMD ["npm", "run", "prod"]
